name: vcd-api-tools Deploy Release
on:
  release:
    types: [created]
jobs:
  publish:
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v2
    - name: Import gpg secret keys
      run: echo $GPG_SECRET_KEYS | gpg --import
      env:
        GPG_SECRET_KEYS: ${{secrets.GPG_SECRET_KEYS}}
    - name: Import gpg ownertrust
      run: echo $GPG_OWNERTRUST | gpg --import-ownertrust
      env:
        GPG_OWNERTRUST: ${{secrets.GPG_OWNERTRUST}}
    - name: Set up JDK 1.8
      uses: actions/setup-java@v1
      with:
        java-version: 1.8
        server-id: ossrh
        server-username: SONATYPE_USERNAME
        server-password: SONATYPE_PASSWORD
    - name: Publish packages
      run: mvn -Prelease --settings build-resources/travis-settings.xml deploy
      env:
        SONATYPE_USERNAME: ${{secrets.SONATYPE_USERNAME}}
        SONATYPE_PASSWORD: ${{secrets.SONATYPE_PASSWORD}}
        GPG_EXECUTABLE: gpg
        GPG_PASSPHRASE: ${{secrets.GPG_PASSPHRASE}}
